{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container mt-4">
  <div class="d-flex justify-content-between mb-3">
    <h2>Listado de Autorizaciones</h2>
    <a href="{% url 'agregar_epp' %}" class="btn btn-outline-dark">Gestionar EPP</a>
  </div>



  <a href="{% url 'validar_rut' %}" class="btn btn-success mb-3">Nueva Autorizaci√≥n</a>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>RUT</th>
        <th>Fecha</th>
        <th>PDF</th>
      </tr>
    </thead>
    <tbody>
      {% for autorizacion in page_obj %}
      <tr>
        <td>{{ autorizacion.nombre_trabajador }}</td>
        <td>{{ autorizacion.rut_trabajador }}</td>
        <td>{{ autorizacion.fecha|date:"d-m-Y H:i" }}</td>
        <td>
          <a href="{{ MEDIA_URL }}autorizaciones_pdf/autorizacion_{{ autorizacion.id }}.pdf" target="_blank">
            <img src="{% static 'img/pdf_icono.png' %}" alt="PDF" width="24">
          </a>
        </td>
      </tr>
      {% empty %}
      <tr><td colspan="4">No se encontraron autorizaciones.</td></tr>
      {% endfor %}
    </tbody>
  </table>

  <!-- Paginador -->
  <nav>
    <ul class="pagination">
      {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}">Anterior</a>
      </li>
      {% endif %}

      {% for num in page_obj.paginator.page_range %}
      <li class="page-item {% if page_obj.number == num %}active{% endif %}">
        <a class="page-link" href="?page={{ num }}">{{ num }}</a>
      </li>
      {% endfor %}

      {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}">Siguiente</a>
      </li>
      {% endif %}
    </ul>
  </nav>
</div>
{% endblock %}